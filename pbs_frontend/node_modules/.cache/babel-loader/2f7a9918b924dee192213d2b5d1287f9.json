{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\aleor\\\\Documents\\\\Projects\\\\pbs_1.0\\\\pbs_frontend\\\\src\\\\user\\\\login.jsx\";\nimport { Component } from \"react\";\nimport axiosInstance from \"../axiosApi\";\nimport jwt_decode from \"jwt-decode\";\nimport axios from \"axios\";\nimport Cookies from \"js-cookie\";\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: \"\",\n      password: \"\",\n      token: Cookies.get(\"refresh_token\"),\n      user_info_data: []\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.getUserInfo = this.getUserInfo.bind(this);\n  }\n\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  getUserId(e) {\n    const token = Cookies.get(\"refresh_token\");\n    const decode = jwt_decode(token);\n    Cookies.set(\"user_id\", decode.user_id);\n  }\n\n  componentDidMount() {\n    const username = Cookies.get(\"username\");\n\n    if (username) {//pass\n    } else {\n      this.getUserInfo();\n    }\n  }\n\n  getUserInfo(event) {\n    const id = Cookies.get(\"user_id\");\n    axios.get(\"http://127.0.0.1:8000/api/urv/\" + id).then(res => {\n      const data = res.data.map(items => {\n        return [items.username, items.password, items.first_name, items.last_name, items.email];\n      });\n      Cookies.set(data);\n    }).then(() => {\n      localStorage.removeItem(\"user_id\");\n      localStorage.removeItem(\"access_token\");\n      localStorage.removeItem(\"refresh_token\");\n    }).then(() => {\n      window.setTimeout(() => {\n        window.history.go(0);\n      }, 1000);\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n    axiosInstance.post(\"/gtv/\", {\n      username: this.state.username,\n      password: this.state.password\n    }).then(result => {\n      axiosInstance.defaults.headers[\"Authorization\"] = \"JWT \" + result.data.access;\n      Cookies.set(\"access_token\", result.data.access);\n      Cookies.set(\"refresh_token\", result.data.refresh, {\n        expires: 15\n      });\n    }).then(() => {\n      this.getUserId();\n    }).then(() => {\n      window.setTimeout(() => {\n        window.history.go(0);\n      }, 1000);\n    }).then(() => {}).catch(error => {\n      throw error;\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Login\", /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.handleSubmit,\n        className: \"login-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Username:\", /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"username\",\n            type: \"text\",\n            value: this.state.username,\n            onChange: this.handleChange,\n            placeholder: \"Enter Username\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Password:\", /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"password\",\n            type: \"password\",\n            value: this.state.password,\n            onChange: this.handleChange,\n            placeholder: \"Enter Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"submit\",\n          value: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Login;","map":{"version":3,"sources":["C:/Users/aleor/Documents/Projects/pbs_1.0/pbs_frontend/src/user/login.jsx"],"names":["Component","axiosInstance","jwt_decode","axios","Cookies","Login","constructor","props","state","username","password","token","get","user_info_data","handleChange","bind","handleSubmit","getUserInfo","event","setState","target","name","value","getUserId","e","decode","set","user_id","componentDidMount","id","then","res","data","map","items","first_name","last_name","email","localStorage","removeItem","window","setTimeout","history","go","catch","err","console","log","preventDefault","post","result","defaults","headers","access","refresh","expires","error","render"],"mappings":"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","sourcesContent":["import { Component } from \"react\";\r\nimport axiosInstance from \"../axiosApi\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport axios from \"axios\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nclass Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      username: \"\",\r\n      password: \"\",\r\n      token: Cookies.get(\"refresh_token\"),\r\n      user_info_data: [],\r\n    };\r\n\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n    this.getUserInfo = this.getUserInfo.bind(this);\r\n  }\r\n\r\n  handleChange(event) {\r\n    this.setState({ [event.target.name]: event.target.value });\r\n  }\r\n\r\n  getUserId(e) {\r\n    const token = Cookies.get(\"refresh_token\");\r\n    const decode = jwt_decode(token);\r\n    Cookies.set(\"user_id\", decode.user_id);\r\n  }\r\n\r\n  componentDidMount() {\r\n    const username = Cookies.get(\"username\");\r\n    if (username) {\r\n      //pass\r\n    } else {\r\n      this.getUserInfo();\r\n    }\r\n  }\r\n\r\n  getUserInfo(event) {\r\n    const id = Cookies.get(\"user_id\");\r\n    axios\r\n      .get(\"http://127.0.0.1:8000/api/urv/\" + id)\r\n      .then((res) => {\r\n        const data = res.data.map((items) => {\r\n          return [\r\n\r\n            items.username,\r\n            items.password,\r\n            items.first_name,\r\n            items.last_name,\r\n            items.email,\r\n          ]\r\n\r\n          \r\n            \r\n        });\r\n        Cookies.set(data);\r\n      })\r\n      .then(() => {\r\n        localStorage.removeItem(\"user_id\");\r\n        localStorage.removeItem(\"access_token\");\r\n        localStorage.removeItem(\"refresh_token\");\r\n      })\r\n      .then(() => {\r\n        window.setTimeout(() => {\r\n          window.history.go(0);\r\n        }, 1000);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  handleSubmit(event) {\r\n    event.preventDefault();\r\n    axiosInstance\r\n      .post(\"/gtv/\", {\r\n        username: this.state.username,\r\n        password: this.state.password,\r\n      })\r\n      .then((result) => {\r\n        axiosInstance.defaults.headers[\"Authorization\"] =\r\n          \"JWT \" + result.data.access;\r\n        Cookies.set(\"access_token\", result.data.access);\r\n        Cookies.set(\"refresh_token\", result.data.refresh, { expires: 15 });\r\n      })\r\n      .then(() => {\r\n        this.getUserId();\r\n      })\r\n      .then(() => {\r\n        window.setTimeout(() => {\r\n          window.history.go(0);\r\n        }, 1000);\r\n      })\r\n      .then(() => {})\r\n      .catch((error) => {\r\n        throw error;\r\n      });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        Login\r\n        <form onSubmit={this.handleSubmit} className=\"login-form\">\r\n          <label>\r\n            Username:\r\n            <input\r\n              name=\"username\"\r\n              type=\"text\"\r\n              value={this.state.username}\r\n              onChange={this.handleChange}\r\n              placeholder=\"Enter Username\"\r\n            />\r\n          </label>\r\n          <label>\r\n            Password:\r\n            <input\r\n              name=\"password\"\r\n              type=\"password\"\r\n              value={this.state.password}\r\n              onChange={this.handleChange}\r\n              placeholder=\"Enter Password\"\r\n            />\r\n          </label>\r\n          <input type=\"submit\" value=\"Submit\" />\r\n        </form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}