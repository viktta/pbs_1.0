{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\aleor\\\\Documents\\\\Projects\\\\pbs_1.0\\\\pbs_frontend\\\\src\\\\user\\\\login.jsx\";\nimport { Component } from \"react\";\nimport axiosInstance from \"../axiosApi\";\nimport jwt_decode from \"jwt-decode\";\nimport axios from \"axios\";\nimport Cookies from \"js-cookie\";\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: \"\",\n      password: \"\",\n      token: Cookies.get(\"refresh_token\"),\n      user_info_data: []\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.getUserInfo = this.getUserInfo.bind(this);\n  }\n\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  getUserId(e) {\n    const token = Cookies.get(\"refresh_token\");\n    const decode = jwt_decode(token);\n    Cookies.set(\"user_id\", decode.user_id);\n  }\n\n  componentDidMount() {\n    const username = Cookies.get(\"username\");\n\n    if (username) {//pass\n    } else {\n      this.getUserInfo;\n    }\n  }\n\n  getUserInfo(event) {\n    event.preventDefault();\n    const id = Cookies.get(\"user_id\");\n    axios.get(\"http://127.0.0.1:8000/api/urv/\" + id).then(res => {\n      // const username = res.data.map((username) => {\n      //   return username.username;\n      // });\n      // const password = res.data.map((password) => {\n      //   return password.password;\n      // });\n      // const last_login = res.data.map((last_login) => {\n      //   return last_login.last_login;\n      // });\n      // const is_superuser = res.data.map((is_superuser) => {\n      //   return is_superuser.is_superuser;\n      // });\n      // const first_name = res.data.map((first_name) => {\n      //   return first_name.first_name;\n      // });\n      // const last_name = res.data.map((last_name) => {\n      //   return last_name.last_name;\n      // });\n      // const email = res.data.map((email) => {\n      //   return email.email;\n      // });\n      // const is_staff = res.data.map((is_staff) => {\n      //   return is_staff.is_staff;\n      // });\n      // const is_active = res.data.map((is_active) => {\n      //   return is_active.is_active;\n      // });\n      // const date_joined = res.data.map((date_joined) => {\n      //   return date_joined.date_joined;\n      // });\n      // const profile = res.data.map((profile) => {\n      //   return profile.profile;\n      // });\n      Cookies.set(res.data);\n    }).then(() => {\n      localStorage.removeItem(\"user_id\");\n      localStorage.removeItem(\"access_token\");\n      localStorage.removeItem(\"refresh_token\");\n    }).then(() => {\n      window.setTimeout(() => {\n        window.history.go(0);\n      }, 1000);\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n    axiosInstance.post(\"/gtv/\", {\n      username: this.state.username,\n      password: this.state.password\n    }).then(result => {\n      axiosInstance.defaults.headers[\"Authorization\"] = \"JWT \" + result.data.access;\n      Cookies.set(\"access_token\", result.data.access);\n      Cookies.set(\"refresh_token\", result.data.refresh, {\n        expires: 15\n      });\n    }).then(() => {\n      this.getUserId();\n    }).then(() => {\n      window.setTimeout(() => {\n        window.history.go(0);\n      }, 1000);\n    }).then(() => {}).catch(error => {\n      throw error;\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Login\", /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.handleSubmit,\n        className: \"login-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Username:\", /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"username\",\n            type: \"text\",\n            value: this.state.username,\n            onChange: this.handleChange,\n            placeholder: \"Enter Username\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Password:\", /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"password\",\n            type: \"password\",\n            value: this.state.password,\n            onChange: this.handleChange,\n            placeholder: \"Enter Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"submit\",\n          value: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Login;","map":{"version":3,"sources":["C:/Users/aleor/Documents/Projects/pbs_1.0/pbs_frontend/src/user/login.jsx"],"names":["Component","axiosInstance","jwt_decode","axios","Cookies","Login","constructor","props","state","username","password","token","get","user_info_data","handleChange","bind","handleSubmit","getUserInfo","event","setState","target","name","value","getUserId","e","decode","set","user_id","componentDidMount","preventDefault","id","then","res","data","localStorage","removeItem","window","setTimeout","history","go","catch","err","console","log","post","result","defaults","headers","access","refresh","expires","error","render"],"mappings":"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","sourcesContent":["import { Component } from \"react\";\r\nimport axiosInstance from \"../axiosApi\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport axios from \"axios\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nclass Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      username: \"\",\r\n      password: \"\",\r\n      token: Cookies.get(\"refresh_token\"),\r\n      user_info_data: [],\r\n    };\r\n\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n    this.getUserInfo = this.getUserInfo.bind(this);\r\n  }\r\n\r\n  handleChange(event) {\r\n    this.setState({ [event.target.name]: event.target.value });\r\n  }\r\n\r\n  getUserId(e) {\r\n    const token = Cookies.get(\"refresh_token\");\r\n    const decode = jwt_decode(token);\r\n    Cookies.set(\"user_id\", decode.user_id);\r\n  }\r\n\r\n  componentDidMount() {\r\n    const username = Cookies.get(\"username\");\r\n    if (username) {\r\n      //pass\r\n    } else {\r\n      this.getUserInfo;\r\n    }\r\n  }\r\n\r\n  getUserInfo(event) {\r\n    event.preventDefault();\r\n    const id = Cookies.get(\"user_id\");\r\n    axios\r\n      .get(\"http://127.0.0.1:8000/api/urv/\" + id)\r\n      .then((res) => {\r\n        // const username = res.data.map((username) => {\r\n        //   return username.username;\r\n        // });\r\n        // const password = res.data.map((password) => {\r\n        //   return password.password;\r\n        // });\r\n        // const last_login = res.data.map((last_login) => {\r\n        //   return last_login.last_login;\r\n        // });\r\n        // const is_superuser = res.data.map((is_superuser) => {\r\n        //   return is_superuser.is_superuser;\r\n        // });\r\n        // const first_name = res.data.map((first_name) => {\r\n        //   return first_name.first_name;\r\n        // });\r\n        // const last_name = res.data.map((last_name) => {\r\n        //   return last_name.last_name;\r\n        // });\r\n        // const email = res.data.map((email) => {\r\n        //   return email.email;\r\n        // });\r\n        // const is_staff = res.data.map((is_staff) => {\r\n        //   return is_staff.is_staff;\r\n        // });\r\n        // const is_active = res.data.map((is_active) => {\r\n        //   return is_active.is_active;\r\n        // });\r\n        // const date_joined = res.data.map((date_joined) => {\r\n        //   return date_joined.date_joined;\r\n        // });\r\n        // const profile = res.data.map((profile) => {\r\n        //   return profile.profile;\r\n        // });\r\n        Cookies.set(res.data);\r\n      })\r\n      .then(() => {\r\n        localStorage.removeItem(\"user_id\");\r\n        localStorage.removeItem(\"access_token\");\r\n        localStorage.removeItem(\"refresh_token\");\r\n      })\r\n      .then(() => {\r\n        window.setTimeout(() => {\r\n          window.history.go(0);\r\n        }, 1000);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  handleSubmit(event) {\r\n    event.preventDefault();\r\n    axiosInstance\r\n      .post(\"/gtv/\", {\r\n        username: this.state.username,\r\n        password: this.state.password,\r\n      })\r\n      .then((result) => {\r\n        axiosInstance.defaults.headers[\"Authorization\"] =\r\n          \"JWT \" + result.data.access;\r\n        Cookies.set(\"access_token\", result.data.access);\r\n        Cookies.set(\"refresh_token\", result.data.refresh, { expires: 15 });\r\n      })\r\n      .then(() => {\r\n        this.getUserId();\r\n      })\r\n      .then(() => {\r\n        window.setTimeout(() => {\r\n          window.history.go(0);\r\n        }, 1000);\r\n      })\r\n      .then(() => {})\r\n      .catch((error) => {\r\n        throw error;\r\n      });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        Login\r\n        <form onSubmit={this.handleSubmit} className=\"login-form\">\r\n          <label>\r\n            Username:\r\n            <input\r\n              name=\"username\"\r\n              type=\"text\"\r\n              value={this.state.username}\r\n              onChange={this.handleChange}\r\n              placeholder=\"Enter Username\"\r\n            />\r\n          </label>\r\n          <label>\r\n            Password:\r\n            <input\r\n              name=\"password\"\r\n              type=\"password\"\r\n              value={this.state.password}\r\n              onChange={this.handleChange}\r\n              placeholder=\"Enter Password\"\r\n            />\r\n          </label>\r\n          <input type=\"submit\" value=\"Submit\" />\r\n        </form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}